# Vectra Guard Configuration
# Simple, clean, rock solid protection

# ============================================
# GUARD LEVEL (Auto-Detection Recommended)
# ============================================

guard_level:
  # Security level: auto (recommended), low, medium, high, paranoid
  # 
  # 'auto' intelligently detects context and adjusts protection:
  #   - Local dev (feature branches) → low protection
  #   - Staging environments → high protection  
  #   - Production environments → paranoid (requires approval)
  #   - Ambiguous context → medium (safe default)
  #
  # Detection considers: git branch, URLs, DB names, file paths, command strings
  # When in doubt, chooses the most protective level (safety first!)
  level: auto
  
  # Override auto-detection: VECTRA_GUARD_LEVEL=low vg exec ...
  allow_user_bypass: true
  bypass_env_var: VECTRAGUARD_BYPASS

# ============================================
# ENVIRONMENT DETECTION
# ============================================

# Teach Vectra Guard your organization's patterns
production_indicators:
  # Git branches that indicate production
  branches:
    - main
    - master
    - production
    - release
  
  # Keywords in URLs, hostnames, database names, paths
  keywords:
    - prod
    - production
    - prd
    - live
    - staging
    - stg
    # Add your org's patterns:
    # - uat
    # - preprod

# ============================================
# LOGGING
# ============================================

logging:
  format: json  # Options: json, text

# ============================================
# SECURITY POLICIES
# ============================================

policies:
  # Git Operations
  monitor_git_ops: true
  block_force_git: true  # Block git push --force
  
  # Production Environment Detection
  detect_prod_env: true
  
  # SQL Detection (only flag destructive operations by default)
  only_destructive_sql: true
  
  # Commands always allowed (safe operations)
  allowlist:
    - "echo *"
    - "ls *"
    - "cat *"
    - "pwd"
    - "git status"
    - "git diff"
    - "git log"
    - "npm install"
    - "npm test"
    - "npm run build"
  
  # Commands blocked or requiring approval
  denylist:
    - "rm -rf /"
    - "sudo rm"
    - ":(){ :|:& };:"  # fork bomb
    - "curl * | sh"
    - "wget * | bash"
    - "git push --force"
    - "DROP DATABASE"
    - "DROP TABLE"

# ============================================
# ENVIRONMENT VARIABLE PROTECTION (Optional)
# ============================================

env_protection:
  enabled: true
  masking_mode: partial  # full, partial, hash, fake
  block_dotenv_read: true

# ============================================
# NOTES
# ============================================
# 
# For advanced configurations and presets, see: docs/CONFIGURATION.md
# 
# Quick override examples:
#   VECTRA_GUARD_LEVEL=low vg exec "risky command"     # Temporary low protection
#   VECTRA_GUARD_LEVEL=paranoid vg exec "prod deploy"  # Force paranoid mode
# 
# The 'auto' level is recommended - let Vectra Guard be smart about context!
